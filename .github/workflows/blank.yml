# Nome do seu workflow, que aparecerá na aba "Actions"
name: Bot Online e Atualização de Ranking

# Gatilhos para iniciar o workflow
on:
  # Roda o workflow a cada 5 minutos para manter o bot online 24/7
  schedule:
    - cron: '*/5 * * * *'
  
  # Roda o workflow quando você faz um "git push" para o branch 'main'
  push:
    branches: [ main ]
  
  # Adiciona um botão na interface do GitHub para rodar o workflow manualmente
  workflow_dispatch:

# Define um único trabalho a ser executado
jobs:
  run_bot:
    # O ambiente onde o trabalho será executado (uma máquina virtual Linux)
    runs-on: ubuntu-latest
    
    # Os passos que o trabalho irá seguir
    steps:
      # Pega o código do seu repositório
      - name: Checkout Repository
        uses: actions/checkout@v4

      # Configura o ambiente Node.js
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      # Instala as dependências listadas no seu package.json
      - name: Install Dependencies
        run: npm install

      # Executa o seu script do bot (node . ou node seu_arquivo.js)
      - name: Run the Bot
        run: node .
        env:
          # Variáveis de ambiente secretas que o seu bot precisa
          DISCORD_TOKEN: ${{ secrets.DISCORD_TOKEN }}
          FACEIT_API_KEY: ${{ secrets.FACEIT_API_KEY }}
          CANAL_RANKING: ${{ secrets.CANAL_RANKING }}
          CANAL_MENSAGENS: ${{ secrets.CANAL_MENSAGENS }}
